.container
  .page-header
    %h1 #{@project.name}: Manage Members
  %ol.breadcrumb
    %li
      =link_to "Projects", projects_path
    %li
      =link_to "#{@project.name}", project_path(@project)
    %li.active Memberships

  .form-group
    -if @membership.errors.any?
      .col-md-offset-2.col-md-7
        .alert.alert-danger
          .h3
            =pluralize(@membership.errors.count, "error")
            ="prohibited this form from being saved:"
          -@membership.errors.full_messages.each do |message|
            .ul
              %li
                =message

  = form_for [@project, @membership], html: { class: "form-inline"} do |f|
    .well
      .row
        .form-group
          .col-sm-1
          = f.collection_select :user_id, User.all, :id, :full_name, {prompt: "Please select a user..."}, {class: "form-control"}
        .form-group
          = f.collection_select :role, Membership::ROLE, :to_s, :to_s, {}, {class: "form-control"}
        .form-group
          = f.submit "Add New Member", {class: "btn btn-primary"}
  .col-sm-6
    %table.table
      %tbody
        - @project.memberships.each do |membership|
          -if membership.id.present? && membership.id.present?
            %tr
              = form_for [@project, membership], html: {class: "form-inline"} do |f|
                %td
                  =link_to membership.user.full_name, user_path(membership.user)
                %td
                  =f.collection_select(:role, Membership::ROLE, :to_s, :to_s, {prompt: membership.role}, class: "form-control")
                %td
                  =f.submit "update", {class: "btn btn-primary"}
                %td
                  = link_to ' ', project_membership_path(@project, membership), method: :delete, class: "glyphicon glyphicon-remove"
